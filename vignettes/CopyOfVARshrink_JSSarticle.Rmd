---
documentclass: jss
author:
  - name: Namgil Lee
    affiliation: Kangwon National University
    address: >
      Department of Information Statistics, 
      Kangwon National University, 
      Chuncheon, Gangwon 24341, South Korea
    email: \email{namgil.lee@kangwon.ac.kr}
    url: https://sites.google.com/site/namgil
  - name: Heon-Young Yang
    affiliation: Kangwon National University
  - name: Sung-Ho Kim
    affiliation: KAIST
    address: > 
      Department of Mathematical Sciences, 
      KAIST,
      Daejeon 305-701, South Korea
    email: \email{sung-ho.kim@kaist.edu}
title:
  formatted: "\\pkg{VARshrink}: Shrinkage Estimation Methods for Vector Autoregressive Models"
  # If you use tex in the formatted title, also supply version without
  plain:     "VARshrink: Shrinkage Estimation Methods for Vector Autoregressive Models"
  # For running headers, if needed
  short:     "\\pkg{VARshrink}"
abstract: >
  We introduce an \proglang{R} software package, \pkg{VARshrink}, for providing shrinkage estimation methods for vector autoregressive (VAR) models. Contrary to the standard ordinary least squares method, shrinkage estimation methods can be applied to high-dimensional VAR models with dimensionality greater than the number of observations. While existing \proglang{R} packages for VAR shrinkage are mostly based on parametric, Bayesian estimation methods using informative priors, the \pkg{VARshrink} aims to be an integrative \proglang{R} package delivering nonparametric, parametric, and semiparametric methods in a unified and consistent manner. The current version of \pkg{VARshrink} contains four shrinkage estimation methods, which are the multivarate ridge regression, a nonparametric shrinkage method, a full Bayesian approach using noninformative priors, and a semiparametric Bayesian approach using informative priors. VAR estimation problems are formulated as a multivariate regression form, so that all the shrinkage estimation methods can be run by one interface function named \code{VARshrink()}. We clearly present mathematical expressions of shrinkage estimators of the shrinkage estimation methods. The effective number of parameters can be calculated based on a shrinkage intensity parameter value, which plays an important role for further statistical analyses. We provide a sample \proglang{R} code for demonstration of the package and comparison of performances of the shrinkage estimation methods.
keywords:
  formatted: [Bayes estimation, vector autoregression (VAR), high-dimensionality, shrinkage, multivariate time series]
  plain:     [Bayes estimation, vector autoregression (VAR), high-dimensionality, shrinkage, multivariate time series]
preamble: >
  \usepackage{amsmath}
  \usepackage{amsfonts}
bibliography: bibVARshrink.bib
output: rticles::jss_article
vignette: >
  %\VignetteIndexEntry{VARshrink_JSSarticle}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



# Numerical Experiments

In this section, we apply the shrinkage estimation methods in the package \pkg{VARshrink} to a benchmark data set and simulated data sets.
Using the benchmark data set, we demonstrate the use of information criteria such as Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC) for comparison of VAR models.
In addition, by simulated experiments, we compute an expected value of the SSE of each shrinkage estimation method for evaluating the accuracy. 

## Benchmark Data

The Canada data set is a benchmark macroeconomic data included in the package \pkg{vars}.
It contains four time series variables representing employment(\code{e}), labour productivity(\code{prod}), real wage(\code{rw}), and unemployment rate(\code{U}), with $84$ observations. We took differene on the data to remove trend, yielding $T = 83$. Figure \ref{fig:diffCanada} shows the differencing result.


```{r, echo = FALSE}
library(kableExtra)
text_tbl <- data.frame(
FM = c("VAR",                  "fevd",    "irf",              "predict", "summary",        "arch.test_sh", "normality.test_sh", "serial.test_sh", "stability_sh"), 
CL = c("varshrinkest, varest", "varfevd", "varshirf, varirf", "varprd",  "varshsum, varsum",    "varcheck",      "varcheck",          "varcheck",       "varstabil"),
MC = c("coef, fevd, fitted, irf, logLik, Phi, plot, predict, print, Psi, resid, summary",                              "plot, print", "plot, print",  "plot, print", "print",                "plot, print",   "plot, print",       "plot, print",    "plot, print"), 
FC = c("Acoef_sh, arch.test_sh, Bcoef_sh, BQ_sh, causality_sh, normality.test_sh, restrict_sh, roots_sh, serial.test_sh, stability_sh", " ", " ", "fanchart", " ", " ", " ", " ", " ")
)
colnames(text_tbl) <- c("Function or method", "Class", "Methods for class", "Functions for class")
knitr::kable(text_tbl,
             caption = "Structure of the package VARshrink.") %>%
             column_spec(1:4, width = "7em", )
```


The shrinkage methods are run with the option \code{const = "const"} since the mean of the data has not been corrected. We set the lag order $p$ at \code{p} $= 1, 2, 3$ to compare several VAR models.
For the semiparametric Bayesian method (\code{method = "sbayes"}), the degree of freedom $\nu$ was automatically selected. 
In addition, we ran the K-fold CV method (\code{method = "kcv"}) for choosing $\lambda$ and $\lambda_v$ values of the semiparametric Bayesian shrinkage estimator. 



We can compare several models by computing their AIC and BIC. The following results in Table \ref{tab:modelcomp} indicate that the NS method produced better VAR coefficients than those of the other methods, and that the AIC took the minimum at $p=3$ while the BIC took the minimum at $p=2$.


The estimated parameters by the NS method with $p=2$ can be analyzed further by the \code{print()} and \code{summary()} methods. For example, 


## Comparative Simulation

For comparison of estimation accuracies by the shrinkage estimation methods, we generated multivariate time series data of length $T = 20, 40, 80, 160$ from $K = 20$ dimensional VAR models of order $p = 1$. We note that when $T = 20$, the sample size $T - p = 19$ becomes smaller than the dimensionality $K = 20$. We set the VAR coefficient matrix, $\mathbf{A}_1$, to have the diagonal entries of 0.6 and off-diagonal entries of zeros except for $K$ entries randomly selected on the lower triangular part of the matrix. The nonzero off-diagonal entries were uniformly randomly drawn from the interval $[-1, -0.2]\cup[0.2, 1]$. Since the coefficient matrix is lower triangular, the diagonal entries determine its eigenvalues, which lead to weak stationarity [@Hamilton94;@Tsay05]. The noise $\boldsymbol\epsilon_t$ was randomly sampled from the multivariate normal distribution whose covariance matrix has diagonal entries of 1 and off-diagonal entries of 0.5.
The mean of sum of squared errors (MSSE) of estimated VAR coefficients, $\widehat{\mathbf{A}}_1$, was computed by
	\begin{equation}
	\sum_{i=1}^K \sum_{j=1}^K \left( \left(\widehat{\mathbf{A}}_1\right)_{ij} -
	\left(\mathbf{A}_1\right)_{ij}  \right)^2.
	\end{equation}
We repeated the experiments 50 times and drew boxplots to compare the SSEs of the shrinkage methods.


```{r comparisons_d20, fig.cap="\\label{fig:comparisons_d20}Comparison of sum of squared errors (SSEs) of the VAR coefficients estimated by the four shrinkage methods. The multivariate time series data were randomly generated from VAR models of order $p = 1$ and dimensionality $K = 20$, and the noise term was randomly drawn from a multivariate normal distribution."}
par(mfrow=c(2, 2), mar = c(2.2, 4.2, 2.5, 1))
boxplot(cars)
boxplot(cars)
boxplot(cars)
boxplot(cars)
```

Figure \ref{fig:comparisons_d20} shows the boxplots of the SSEs of the VAR coefficients estimated by the four shrinkage methods. The full Bayesian approach (FBayes) and the semiparametric Bayesian approach (SBayes) yielded the best accuracies among the four methods. 


---

# Conclusions

We wrote an \proglang{R} software package \pkg{VARshrink} for shrinkage estimation of VAR model parameters.
The shrinkage methods included in this package are the multivariate ridge regression [@Hoerl70; @Golub79],
a nonparametric shrinkage method [@Rhein07c],
a full Bayesian shrinkage method [@Ni05],
and a semiparametric Bayesian shrinkage method [@LeeChoiKim2016].
An advantage of this package is the integration of the nonparametric, parametric, and semiparametric methods
in one frame via a common interface function \code{VARshrink()},
which makes it easy and convenient to use various types of shrinkage estimation methods.
Moreover, we note that the shrinkage estimation methods implemented in the current version have not been widely implemented in \proglang{R} packages in the context of VAR models.

We demonstrated the use of model selection criteria as AIC and BIC by using benchmark time series data. We note that computation of the log-likelihood of an estimated model must consider the actual distribution assumption of each method. We explained that the multivariate normal distribution is not the only choice for a distribution of noise, but another distributions such as the multivariate t-distribution can be chosen. Moreover, an effective number of parameters must be calculated for computing the AIC and BIC values. In this case, a large number of shrinkage parameter value leads to a small value of the effectie number of parameters. In the package \pkg{VARshrink}, effective number of parameters is computed automatically based on the selected shrinkage parameter value. 

Shrinkage methods are quite crucial especially for high dimensional VAR models.
Bayesian approaches have been developed widely for VAR models in the literature for various purposes. However, the computational time for carrying out MCMC processes may be intractably high for high dimensional VAR models.
For this reason, it is important to use nonparametric and semiparametric shrinkage estimation methods together to produce computationally feasible estimates of model parameters.
The \proglang{R} package \pkg{VARshrink} is the first step to an integrative and general types of software packages for VAR models.
Moreover, this package can be extended to include other shrinkage methods 
such as Bayesian shrinkage methods using several types of different prior distributions.

# References {-}
